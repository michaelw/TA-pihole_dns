# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_pihole_dns/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_pihole_dns/default
# into ../local and edit there.

#====================================
# pihole
#====================================
[pihole]
SHOULD_LINEMERGE             = false
LINE_BREAKER                 = ([\r\n]+)
NO_BINARY_CHECK              = true
CHARSET                      = UTF-8
ANNOTATE_PUNCT               = false
REPORT-pihole_config         = pihole_config
REPORT-pihole_forwarded      = pihole_forwarded
REPORT-pihole_gravity        = pihole_gravity
REPORT-pihole_pid            = pihole_pid
REPORT-pihole_query          = pihole_query
REPORT-pihole_response       = pihole_response
REPORT-pihole_src_src_port   = pihole_src_src_port
REPORT-pihole_transaction_id = pihole_transaction_id
REPORT-pihole_validation     = pihole_validation
FIELDALIAS-pihole_src        = src_ip AS src
EVAL-name                    = if(match(name, "\/etc.*"), "local_list_reply",name)
EVAL-reply_code              = case(isnotnull(reply_code), reply_code, isnotnull(answer) AND answer=="0.0.0.0", "Refused", vendor_action == "blocked", "Refused", isnull(answer), null(), true(), "NoError")
EVAL-vendor_product          = "Pi-hole"
LOOKUP-pihole_rcodes         = pihole_rcodes_lookup name AS reply_code OUTPUTNEW rcode AS reply_code_id,     description AS rcode_decription
LOOKUP-pihole_rtypes         = pihole_rtypes_lookup type AS record_type OUTPUTNEW type_id AS record_type_id, description AS record_description

#====================================
# pihole FTL
#====================================
[pihole:ftl]
SHOULD_LINEMERGE = false
LINE_BREAKER     = ([\r\n]+)
NO_BINARY_CHECK  = true
TIME_FORMAT      = %Y-%m-%d %H:%M:%S.%3N
TIME_PREFIX      = ^\[
MAX_TIMESTAMP_LOOKAHEAD     = 23
CHARSET                     = UTF-8
ANNOTATE_PUNCT              = false
REPORT-pihole_ftl_metrics   = pihole_ftl_metrics
REPORT-pihole_ftl_config    = pihole_ftl_config
REPORT-pihole_ftl_msg       = pihole_ftl_msg
REPORT-pihole_ftl_blacklist = pihole_ftl_blacklist
EVAL-vendor_product         = "Pi-hole"

#====================================
# pihole DHCP
#====================================
[pihole:dhcp]
SHOULD_LINEMERGE              = false
LINE_BREAKER                  = ([\r\n]+)
NO_BINARY_CHECK               = true
CHARSET                       = UTF-8
ANNOTATE_PUNCT                = false
REPORT-pihole_dhcp_events     = pihole_dhcp_events
REPORT-pihole_dhcp_lease      = pihole_dhcp_lease
REPORT-pihole_dhcp_lease_info = pihole_dhcp_lease_info
FIELDALIAS-pihole_dhcp_rename = client_ip ASNEW dest_ip, client_mac ASNEW dest_mac, client_name ASNEW dest_nt_host, host ASNEW dvc
EVAL-lease_time               = replace(lease_time, "d", " day(s)")
EVAL-vendor_product           = "Pi-hole"